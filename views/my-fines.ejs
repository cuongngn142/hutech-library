<%- include('partials/header') %>

<div class="container mt-4">
    <h2>Phiếu phạt</h2>
    
    <% if (fines && fines.length > 0) { %>
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>Sách</th>
                        <th>Ngày mượn</th>
                        <th>Ngày trả dự kiến</th>
                        <th>Ngày trả thực tế</th>
                        <th>Lý do</th>
                        <th>Số tiền</th>
                        <th>Ngày phạt</th>
                        <th>Trạng thái</th>
                    </tr>
                </thead>
                <tbody>
                    <% fines.forEach(function(fine) { %>
                        <tr>
                            <td>
                                <div class="d-flex align-items-center">
                                    <% if (fine.URLAnh) { %>
                                        <img src="<%= fine.URLAnh %>" alt="<%= fine.TenSach %>" class="me-3" style="width: 50px; height: 70px; object-fit: cover;">
                                    <% } %>
                                    <div>
                                        <h5 class="mb-0"><%= fine.TenSach %></h5>
                                        <p class="mb-0">Tác giả: <%= fine.TacGia %></p>
                                    </div>
                                </div>
                            </td>
                            <td><%= new Date(fine.NgayMuon).toLocaleDateString('vi-VN') %></td>
                            <td><%= new Date(fine.NgayTraDuKien).toLocaleDateString('vi-VN') %></td>
                            <td><%= fine.NgayTraThucTe ? new Date(fine.NgayTraThucTe).toLocaleDateString('vi-VN') : 'Chưa trả' %></td>
                            <td><%= fine.LyDo %></td>
                            <td><%= fine.SoTienPhat.toLocaleString('vi-VN') %> đ</td>
                            <td><%= new Date(fine.NgayPhat).toLocaleDateString('vi-VN') %></td>
                            <td>
                                <span class="badge <%= fine.TrangThai === 'Đã đóng phạt' ? 'bg-success' : 'bg-danger' %>">
                                    <%= fine.TrangThai %>
                                </span>
                            </td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
    <% } else { %>
        <div class="alert alert-info">
            Bạn chưa có phiếu phạt nào. <a href="/sach">Tiếp tục tìm sách</a>
        </div>
    <% } %>
</div>

<%- include('partials/footer') %> 